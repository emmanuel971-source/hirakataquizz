// Variable globale pour le batch
let pseudoBatch = [];

// Fonction pour g√©n√©rer un pseudo localement
function generateLocalPseudo(words) {
  const { jpnWords, engWords } = words;
  const jpn = jpnWords[Math.floor(Math.random() * jpnWords.length)];
  const eng = engWords[Math.floor(Math.random() * engWords.length)];
  return {
    pseudo: `${jpn}${eng}`,
    jpnWord: jpn,
    engWord: eng
  };
}

// Modifie generateNewPseudo() pour utiliser le batch local
async function generateNewPseudo() {
  const pseudoText = document.getElementById('pseudo-text');
  const errorDiv = document.getElementById('create-error');
  const validateBtn = document.getElementById('validate-pseudo-btn');

  // Animation de chargement (seulement si batch vide)
  pseudoText.textContent = 'üîÑ';
  validateBtn.disabled = true;
  errorDiv.style.display = 'none';

  try {
    // Charger wordLists du localStorage (charg√©es dans initGame())
    const storedWords = JSON.parse(localStorage.getItem('wordLists'));
    if (!storedWords) {
      throw new Error('Word lists non disponibles');
    }

    // Si batch vide, g√©n√©rer 10 nouveaux
    if (pseudoBatch.length === 0) {
      for (let i = 0; i < 10; i++) {
        pseudoBatch.push(generateLocalPseudo(storedWords));
      }
      console.log('‚úÖ Batch de 10 pseudos g√©n√©r√© localement');
    }

    // Prendre le premier du batch
    currentPseudoProposal = pseudoBatch.shift();
    pseudoText.textContent = currentPseudoProposal.pseudo;
    validateBtn.disabled = false;
    console.log('‚úÖ Pseudo propos√©:', currentPseudoProposal.pseudo);

  } catch (error) {
    errorDiv.textContent = 'Erreur lors de la g√©n√©ration';
    errorDiv.style.display = 'block';
    pseudoText.textContent = '‚ùå';
    console.error('‚ùå Erreur:', error);
  }
}
